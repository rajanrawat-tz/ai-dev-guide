# Phase 5: Pull Request & Release

**Source of truth**: `AI-DEVELOPMENT-SOP-v1.4.0-FINAL.md` (Phase 5 section)

---

## Objective
Create a high-quality pull request, get approval, and merge code into main branch.

---

## Step 5.1: Prepare Pull Request

**Before creating PR:**

```bash
# Ensure all code is committed
git status

# Rebase on latest main (if needed)
git fetch origin
git rebase origin/main

# Run full test suite one more time
npm run test:all  # or your test command

# Final lint check
npm run lint
```

---

## Step 5.2: Create Pull Request

**Using GitHub CLI:**

```bash
gh pr create \
  --title "feat(US-XX): [Feature name]" \
  --body-file .github/PR_TEMPLATE.md \
  --assignee @me \
  --label "feature,ready-for-review"
```

### Pull Request Description Template

```markdown
## Summary
[Brief description of what this PR does]

## User Story
Closes #[user-story-issue-number]

## Tasks Completed
Closes #[task-1-issue-number]
Closes #[task-2-issue-number]
Closes #[task-3-issue-number]

## AI Tool Chain
- **Generated by**: [AI model name]
- **Reviewed by**: [AI model 1], [AI model 2], [Tool 1], [Tool 2]

## Changes
- [Change 1]
- [Change 2]
- [Change 3]

## Testing
- [ ] Unit tests pass (coverage: XX%)
- [ ] Integration tests pass
- [ ] Docker tests pass
- [ ] Manual testing completed

## Documentation
- [ ] README updated
- [ ] API docs updated
- [ ] Quickstart guide created
- [ ] Configuration documented

## Constitution Compliance
- [ ] Architecture patterns followed
- [ ] TDD workflow followed
- [ ] Code quality standards met
- [ ] Security requirements met

## Review Checklist
- [ ] Code follows constitution
- [ ] All acceptance criteria met
- [ ] Tests provide adequate coverage
- [ ] No critical issues from AI review
- [ ] Documentation is complete
- [ ] Breaking changes documented (if any)

## Screenshots/Demo
[If applicable, add screenshots or demo links]

## Deployment Notes
[Any special deployment considerations]
```

---

## Step 5.3: Request Reviews

**Assign reviewers:**

```bash
# Add human reviewers
gh pr edit --add-reviewer @senior-dev
gh pr edit --add-reviewer @tech-lead

# Add to review list in team channel
```

**If automated PR review tools are configured** (CodeRabbit, etc.), they'll automatically review.

---

## Step 5.4: Address Review Comments

**For each review comment:**

1. **If it's a valid issue**: Fix it
2. **If you disagree**: Discuss with reviewer (with evidence)
3. **If it's out of scope**: Create follow-up issue

**After fixes:**
```bash
# Commit changes
git add .
git commit -m "fix: address review comments"
git push

# Notify reviewers
gh pr comment --body "Review comments addressed, ready for re-review"
```

---

## Step 5.5: Merge & Deploy

**When approved:**

```bash
# Merge PR (use your team's merge strategy)
gh pr merge --squash  # or --merge or --rebase

# Delete feature branch
git branch -d US-XX-feature-name
git push origin --delete US-XX-feature-name

# Close related issues (if not auto-closed)
gh issue close [issue-number] --comment "Completed in PR #XX"
```

---

## Step 5.6: Verify Deployment

**After merge to main:**

```bash
# Watch deployment (if CI/CD configured)
# Monitor logs, errors, metrics

# Smoke test in staging/production
# Verify feature works as expected

# Update stakeholders
```

---

## Checkpoint 5 (GATE)

Before considering feature complete:

- [ ] PR created with complete description
- [ ] All PR checklist items completed
- [ ] Human reviewers approved
- [ ] All review comments addressed
- [ ] PR merged successfully
- [ ] Deployment verified
- [ ] Stakeholders notified

**If checkpoint fails**: Address issues before closing feature.
